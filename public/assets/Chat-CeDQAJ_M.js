import{y as w,r as a,u as N,j as e,p as h,V as v,m as g}from"./index-C9s3gB-3.js";import{P as D}from"./phone-BFwiWRG9.js";import{E as C,P as E,S}from"./smile-DMWQwuYE.js";import{S as M}from"./send-DtrpSvwd.js";function T(){const[P,o]=w("/chat/:consultantId"),y=(o==null?void 0:o.consultantId)||"1",[c,i]=a.useState([]),[r,d]=a.useState(""),[f,m]=a.useState(!1),u=a.useRef(null),{data:t}=N({queryKey:[`/api/consultants/${y}`]}),b=()=>{var s;(s=u.current)==null||s.scrollIntoView({behavior:"smooth"})};a.useEffect(()=>{b()},[c]),a.useEffect(()=>{const s=[{id:"1",content:"Olá! Obrigada por escolher uma consulta comigo. Como posso te ajudar hoje?",timestamp:new Date(Date.now()-3e5),sender:"consultant",type:"text",status:"read"},{id:"2",content:"Oi! Gostaria de uma orientação sobre minha vida amorosa.",timestamp:new Date(Date.now()-24e4),sender:"user",type:"text",status:"read"},{id:"3",content:"Perfeito! Vou puxar as cartas para você. Me fale um pouco sobre sua situação atual no amor.",timestamp:new Date(Date.now()-18e4),sender:"consultant",type:"text",status:"read"}];i(s)},[]);const x=()=>{if(!r.trim())return;const s={id:Date.now().toString(),content:r,timestamp:new Date,sender:"user",type:"text",status:"sent"};i(n=>[...n,s]),d(""),setTimeout(()=>{m(!0),setTimeout(()=>{const n={id:(Date.now()+1).toString(),content:"Entendi. Deixe-me consultar as cartas para te dar uma orientação mais precisa...",timestamp:new Date,sender:"consultant",type:"text",status:"sent"};i(l=>[...l,n]),m(!1)},2e3)},1e3)},j=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),x())},p=()=>{const s=(t==null?void 0:t.whatsapp)||"5511999999999",n=(t==null?void 0:t.name)||"Consultor",l=encodeURIComponent(`Olá ${n}, gostaria de uma consulta!`);window.open(`https://wa.me/${s}?text=${l}`,"_blank")};return e.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:(t==null?void 0:t.imageUrl)||"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=100",alt:(t==null?void 0:t.name)||"Consultor",className:"w-12 h-12 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-gray-800",children:(t==null?void 0:t.name)||"Consultor Especialista"}),e.jsx("p",{className:"text-sm text-green-500",children:"Online"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:p,className:"p-2 bg-green-500 text-white rounded-full hover:bg-green-600 transition-colors",title:"Continuar no WhatsApp",children:e.jsx(h,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors",children:e.jsx(D,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 bg-purple-500 text-white rounded-full hover:bg-purple-600 transition-colors",children:e.jsx(v,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(C,{className:"w-5 h-5 text-gray-600"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[c.map(s=>e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`flex ${s.sender==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ${s.sender==="user"?"bg-primary text-white":"bg-white text-gray-800 shadow-sm"}`,children:[e.jsx("p",{className:"text-sm",children:s.content}),e.jsx("p",{className:`text-xs mt-1 ${s.sender==="user"?"text-purple-200":"text-gray-500"}`,children:s.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},s.id)),f&&e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex justify-start",children:e.jsx("div",{className:"bg-white rounded-2xl px-4 py-2 shadow-sm",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})}),e.jsx("div",{ref:u})]}),e.jsxs("div",{className:"bg-white border-t border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(E,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{className:"flex-1 flex items-center bg-gray-100 rounded-full px-4 py-2",children:[e.jsx("input",{type:"text",value:r,onChange:s=>d(s.target.value),onKeyPress:j,placeholder:"Digite sua mensagem...",className:"flex-1 bg-transparent outline-none text-gray-800"}),e.jsx("button",{className:"p-1 hover:bg-gray-200 rounded-full",children:e.jsx(S,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("button",{onClick:x,disabled:!r.trim(),className:"p-2 bg-primary text-white rounded-full hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"mt-3 text-center",children:e.jsxs("button",{onClick:p,className:"inline-flex items-center space-x-2 bg-green-500 text-white px-6 py-2 rounded-full hover:bg-green-600 transition-colors",children:[e.jsx(h,{className:"w-4 h-4"}),e.jsx("span",{children:"Continuar conversa no WhatsApp"})]})})]})]})}export{T as default};
