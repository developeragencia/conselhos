import{g as Z,R as u,r as p,n as ee,E as se,u as I,o as F,j as e,C as m,e as x,b as D,c as te,I as L,f as v,B as S,S as ae,p as R,V as re,q as z}from"./index-C9s3gB-3.js";import{L as N}from"./label-CHUtYmr4.js";import{S as B,a as q,b as A,c as W,d as j}from"./select-B2paXjBP.js";import{D as ie,a as ne,b as le,c as ce,d as oe}from"./dialog-CSFgGmJe.js";import{U as _}from"./users-mCE-RU_j.js";import{C as de}from"./clock-CaGl1oH_.js";import{F as me}from"./filter-CCAkTebF.js";import{S as xe}from"./search-CnWuNt8P.js";import{C as ue}from"./credit-card-D0hcmZDe.js";import{P as he}from"./phone-BFwiWRG9.js";import"./index-BdQq_4o_.js";import"./index-vsrGE1fA.js";import"./index-CmDifxQn.js";import"./index-Bk9LhQaI.js";import"./check-BVyohu0C.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=Z("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var V={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},$=u.createContext&&u.createContext(V),je=["attr","size","title"];function fe(s,r){if(s==null)return{};var a=ge(s,r),i,n;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(s);for(n=0;n<c.length;n++)i=c[n],!(r.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(s,i)&&(a[i]=s[i])}return a}function ge(s,r){if(s==null)return{};var a={};for(var i in s)if(Object.prototype.hasOwnProperty.call(s,i)){if(r.indexOf(i)>=0)continue;a[i]=s[i]}return a}function b(){return b=Object.assign?Object.assign.bind():function(s){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(s[i]=a[i])}return s},b.apply(this,arguments)}function k(s,r){var a=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);r&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),a.push.apply(a,i)}return a}function y(s){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?k(Object(a),!0).forEach(function(i){ve(s,i,a[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(a,i))})}return s}function ve(s,r,a){return r=Ne(r),r in s?Object.defineProperty(s,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):s[r]=a,s}function Ne(s){var r=be(s,"string");return typeof r=="symbol"?r:r+""}function be(s,r){if(typeof s!="object"||!s)return s;var a=s[Symbol.toPrimitive];if(a!==void 0){var i=a.call(s,r||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}function K(s){return s&&s.map((r,a)=>u.createElement(r.tag,y({key:a},r.attr),K(r.child)))}function ye(s){return r=>u.createElement(Ce,b({attr:y({},s.attr)},r),K(s.child))}function Ce(s){var r=a=>{var{attr:i,size:n,title:c}=s,f=fe(s,je),h=n||a.size||"1em",o;return a.className&&(o=a.className),s.className&&(o=(o?o+" ":"")+s.className),u.createElement("svg",b({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},a.attr,i,f,{className:o,style:y(y({color:s.color||a.color},a.style),s.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),c&&u.createElement("title",null,c),s.children)};return $!==void 0?u.createElement($.Consumer,null,a=>r(a)):r(V)}function we(s){return ye({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"},child:[]}]})(s)}function We(){const[s,r]=p.useState(null),[a,i]=p.useState(""),[n,c]=p.useState(10),[f,h]=p.useState(""),[o,C]=p.useState(""),[Q,w]=p.useState(!1),{toast:g}=ee(),H=se(),{data:U=[],isLoading:G}=I({queryKey:["/api/consultation/available-consultants"],refetchInterval:1e4}),{data:d}=I({queryKey:["/api/consultation/stats"],refetchInterval:5e3}),P=F({mutationFn:t=>z("POST","/api/consultation/queue",t),onSuccess:t=>{g({title:"Entrada na fila confirmada",description:`Posição: ${t.position}. Tempo estimado: ${t.estimatedWaitTime} min`}),w(!1),H.invalidateQueries({queryKey:["/api/consultation/stats"]})},onError:t=>{g({title:"Erro ao entrar na fila",description:t.message||"Tente novamente em alguns segundos",variant:"destructive"})}}),O=F({mutationFn:t=>z("POST","/api/consultation/room",t),onSuccess:t=>{g({title:"Sala criada com sucesso",description:"Redirecionando para a consulta..."}),window.location.href=`/consultation/${t.roomId}`},onError:t=>{g({title:"Erro ao criar sala",description:t.message||"Tente novamente",variant:"destructive"})}}),E=U.filter(t=>{const l=t.name.toLowerCase().includes(f.toLowerCase())||t.specialty.toLowerCase().includes(f.toLowerCase()),X=!o||t.specialtyAreas.includes(o),Y=t.pricePerMinute<=n;return l&&X&&Y}),J=()=>{if(!s||!a){g({title:"Informações incompletas",description:"Selecione um consultor e método de comunicação",variant:"destructive"});return}s.isOnline&&s.currentClients===0?O.mutate({consultantId:s.id,communicationMethod:a,creditsPerMinute:s.pricePerMinute}):P.mutate({consultantId:s.id,serviceType:s.specialty,communicationMethod:a,maxPricePerMinute:s.pricePerMinute})},M=t=>{switch(t){case"video":return e.jsx(re,{className:"w-4 h-4"});case"audio":return e.jsx(he,{className:"w-4 h-4"});case"chat":return e.jsx(R,{className:"w-4 h-4"});case"whatsapp":return e.jsx(we,{className:"w-4 h-4"});default:return e.jsx(R,{className:"w-4 h-4"})}},T=t=>{switch(t){case"video":return"Vídeo Chamada";case"audio":return"Chamada de Áudio";case"chat":return"Chat de Texto";case"whatsapp":return"WhatsApp";default:return t}};return G?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-purple-500 border-t-transparent rounded-full"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50",children:[e.jsx("div",{className:"bg-white shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Consultas Espirituais Online"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Conecte-se instantaneamente com nossos especialistas através de chat, vídeo, áudio ou WhatsApp"})]}),d&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[e.jsx(m,{children:e.jsxs(x,{className:"p-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center text-green-600 mb-2",children:[e.jsx(pe,{className:"w-5 h-5 mr-2 fill-current"}),e.jsx("span",{className:"font-semibold",children:(d==null?void 0:d.consultantsOnline)||0})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Consultores Online"})]})}),e.jsx(m,{children:e.jsxs(x,{className:"p-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center text-blue-600 mb-2",children:[e.jsx(_,{className:"w-5 h-5 mr-2"}),e.jsx("span",{className:"font-semibold",children:d.activeConsultations})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Consultas Ativas"})]})}),e.jsx(m,{children:e.jsxs(x,{className:"p-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center text-purple-600 mb-2",children:[e.jsx(de,{className:"w-5 h-5 mr-2"}),e.jsxs("span",{className:"font-semibold",children:[d.averageWaitTime,"min"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Tempo Médio"})]})}),e.jsx(m,{children:e.jsxs(x,{className:"p-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center text-orange-600 mb-2",children:[e.jsx(_,{className:"w-5 h-5 mr-2"}),e.jsx("span",{className:"font-semibold",children:d.queueSize})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Na Fila"})]})})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs(m,{className:"mb-8",children:[e.jsx(D,{children:e.jsxs(te,{className:"flex items-center",children:[e.jsx(me,{className:"w-5 h-5 mr-2"}),"Filtrar Consultores"]})}),e.jsx(x,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"search",children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(L,{id:"search",placeholder:"Nome ou especialidade...",value:f,onChange:t=>h(t.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"specialty",children:"Especialidade"}),e.jsxs(B,{value:o,onValueChange:C,children:[e.jsx(q,{children:e.jsx(A,{placeholder:"Todas especialidades"})}),e.jsxs(W,{children:[e.jsx(j,{value:"",children:"Todas especialidades"}),e.jsx(j,{value:"tarot",children:"Tarot"}),e.jsx(j,{value:"astrologia",children:"Astrologia"}),e.jsx(j,{value:"mediunidade",children:"Mediunidade"}),e.jsx(j,{value:"numerologia",children:"Numerologia"})]})]})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"price",children:"Preço máximo por minuto"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{id:"price",type:"number",min:"1",max:"20",value:n,onChange:t=>c(Number(t.target.value))}),e.jsx("span",{className:"text-sm text-gray-600",children:"R$"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(v,{variant:"outline",onClick:()=>{h(""),C(""),c(10)},className:"w-full",children:"Limpar Filtros"})})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(t=>e.jsxs(m,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-r from-purple-500 to-blue-500 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold",children:t.name.charAt(0)})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.specialty})]})]}),e.jsx("div",{className:"flex items-center",children:t.isOnline?e.jsx(S,{variant:"default",className:"bg-green-500",children:"Online"}):e.jsx(S,{variant:"secondary",children:"Offline"})})]})}),e.jsxs(x,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:t.bio}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(ae,{className:"w-4 h-4 text-yellow-500 mr-1"}),t.rating]}),e.jsxs("span",{children:[t.totalConsultations," consultas"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(ue,{className:"w-4 h-4 text-purple-500 mr-1"}),"R$ ",t.pricePerMinute,"/min"]}),e.jsxs("span",{className:"text-gray-600",children:[t.currentClients," cliente(s) ativo(s)"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:t.communicationMethods.map(l=>e.jsxs(S,{variant:"outline",className:"text-xs",children:[M(l),e.jsx("span",{className:"ml-1",children:T(l)})]},l))}),e.jsxs(ie,{open:Q&&(s==null?void 0:s.id)===t.id,onOpenChange:w,children:[e.jsx(ne,{asChild:!0,children:e.jsx(v,{className:"w-full",onClick:()=>r(t),disabled:!t.isOnline,children:t.isOnline?t.currentClients===0?"Consultar Agora":"Entrar na Fila":"Indisponível"})}),e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(oe,{children:["Iniciar Consulta com ",t.name]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"communication",children:"Método de Comunicação"}),e.jsxs(B,{value:a,onValueChange:i,children:[e.jsx(q,{children:e.jsx(A,{placeholder:"Escolha como deseja se comunicar"})}),e.jsx(W,{children:t.communicationMethods.map(l=>e.jsx(j,{value:l,children:e.jsxs("div",{className:"flex items-center",children:[M(l),e.jsx("span",{className:"ml-2",children:T(l)})]})},l))})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Resumo da Consulta"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Consultor:"}),e.jsx("span",{children:t.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Especialidade:"}),e.jsx("span",{children:t.specialty})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Preço por minuto:"}),e.jsxs("span",{children:["R$ ",t.pricePerMinute]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status:"}),e.jsx("span",{children:t.currentClients===0?"Disponível agora":`${t.currentClients} na frente`})]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"outline",onClick:()=>w(!1),className:"flex-1",children:"Cancelar"}),e.jsx(v,{onClick:J,disabled:P.isPending||O.isPending,className:"flex-1",children:P.isPending||O.isPending?"Conectando...":t.currentClients===0?"Iniciar Agora":"Entrar na Fila"})]})]})]})]})]})]},t.id))}),E.length===0&&e.jsx(m,{className:"text-center py-12",children:e.jsxs(x,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Nenhum consultor encontrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Tente ajustar os filtros ou volte mais tarde"}),e.jsx(v,{variant:"outline",onClick:()=>{h(""),C(""),c(10)},children:"Limpar Filtros"})]})})]})]})}export{We as default};
